<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<!-- I can't control how the embedded content works (and it could change over time): can't set default-src, need to allow everything -->
	<meta http-equiv="content-security-policy" content="block-all-mixed-content; object-src 'none'; form-action 'none';">
	<!-- youtube needs a referrer for some videos that contains music, otherwise the player throws error code 150 -->
	<meta name="referrer" content="strict-origin">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>YouTube in an iframe</title>

	<link href="../common/style.css" rel="stylesheet">
	<script defer src="script.js" type="module"></script>
	<script defer src="https://www.youtube.com/iframe_api"></script>
</head>

<body>
	<header>
		<h3>YouTube in an iframe</h3>
		<form id="form" autocomplete="on" target="_self" action="about:blank">
			<label for="type">Query type: </label>
			<select id="type" required>
				<option value="url">YouTube video URL</option>
				<option value="playlist">YouTube playlist URL</option>
				<option value="search" selected>Search query</option>
				<option value="user_uploads">Channel name</option>
			</select>
			<br>
			<label for="query">Query text: </label>
			<input id="query" type="search" size="30" minlength="1" maxlength="768" inputmode="search" autofocus required>
			<br>
			<button type="submit">Load video</button>
		</form>
	</header>
	<main class="iframe-box">
		<!-- I'm aware of the fact that youtube can just remove these restrictions, since I'm executing their script in the main window's scope.
		The restrictions are just friendly suggestions, not hard rules. -->
		<iframe class="iframe" id="yt-iframe" contenteditable="false" allowfullscreen allow="fullscreen *; encrypted-media *;"
		 sandbox="allow-scripts allow-same-origin" src="https://www.youtube.com/embed/feBF_IY-HI8?hl=en-US&gl=US&enablejsapi=1&cc_lang_pref=en&modestbranding=1"></iframe>
	</main>
	<footer>
		<form>
			<label for="resolution">Prefer quality: </label>
			<select id="resolution">
				<option value="tiny">144p</option>
				<option value="small">240p</option>
				<option value="medium">360p</option>
				<option value="large">480p</option>
				<option value="hd720" selected>720p</option>
				<option value="hd1080">1080p</option>
				<option value="hd1440">1440p</option>
				<option value="hd2160">2160p</option>
			</select>
			<label for="speed">Speed: </label>
			<select id="speed">
				<option value="0.25">0.25x</option>
				<option value="0.5">0.5x</option>
				<option value="0.75">0.75x</option>
				<option value="1" selected>1x</option>
				<option value="1.25">1.25x</option>
				<option value="1.5">1.5x</option>
				<option value="1.75">1.75x</option>
				<option value="2">2x</option>
			</select>
		</form>
		<p>Channel: <b id="channel"></b></p>
		<p>Title: <b id="videoTitle"></b></p>
		<p>Duration: <b id="videoLength"></b></p>
	</footer>
</body>

</html>